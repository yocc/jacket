# ~/.bashrc

----

[toc]



## PATH 重复, 排重

```shell
# 1.
# 采用

# 既保持了 PATH 内部顺序, 又排除了因多次执行 `source ~/.bashrc` 而造成的重复项
# 唯一需要注意的是 /bin/awk 是否存在
export PATH="$(echo "$PATH" | /bin/awk 'BEGIN{RS=":";}{sub(sprintf("%c$",10),"");if(A[$0]){}else{A[$0]=1;printf(((NR==1)?"":":")$0)}}')";
```



```shell
# 2.
# 未采用, 因为 uniq 要与 sort 一起使用才有效, 但 sort 会改变 PATH 内部顺序. 弃用.

#
################################################################
# path-cleanup
#
# This must be run as "source path-cleanup" or ". path-cleanup"
# so the current shell gets the changes.

pathlist=`echo $PATH | sed 's/:/\n/g' | sort | uniq`

# echo "Starting PATH: $PATH"
# echo "pathlist: $pathlist"
unset PATH
# echo "After unset, PATH: $PATH"
for dir in $pathlist
do
    if test -d $dir ; then
        if test -z $PATH; then
            PATH=$dir
        else
            PATH=$PATH:$dir
        fi
    fi
done
export PATH
# echo "After loop, PATH: $PATH"
```



## PATH 执行顺序

```shell
~/.bashrc 的 PATH 中的配置里, 靠前的配置优先执行. 即, 优先执行最先找到的位置.
PATH=/usr/local/vim9/bin:/usr/local/vim8/bin
优先执行 vim9
```



## source 和 . 和 export 和 unset

```shell
多次执行 $ source ~/.bashrc, 会出现 PATH 的值大量重复, 如何解决?
In summary:
source or . => imports.
export => exports.
unset => unexports.
```



## login 和 non-login shell 加载顺序

```shell
登录系统时, shell 环境是如何加载的?
login shell加载环境变量的顺序是：
1. /etc/profile 
2. ~/.bash_profile
3. ~/.bashrc 
4. /etc/bashrc 

non-login shell加载环境变量的顺序是：
1. ~/.bashrc 
2. /etc/bashrc
```





## See Also

https://stackoverflow.com/questions/11650840/remove-redundant-paths-from-path-variable