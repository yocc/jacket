# define & declare

[toc]

## Overview

### 声明和定义的区别
#### 声明和定义不同
- 声明的意义在于告诉编译器程序单元的存在.
- 定义则明确指示程序单元的意义.
- C 语言通过 extern 进行程序单元的声明.
- 一些程序单元(函数、结构体)在声明时可以省略 extern.
- 严格意义上的声明和定义并不相同.

关于声明和定义有如下两种特殊情况需要注意:

##### 声明和定义如果变量类型不一致，将导致错误的解析。

```c++
// global.c
float g_f = 10.0;

// main.c
extern int g_f;

int main(void)
{
		printf("%d\n", g_f);	// 将得到错误的结果
		return 0;
}
```

##### 对于结构体类型如果只有声明而没有定义是无法使用 sizeof 得到结构体类型的大小的

```c++
// global.h
struct Test
{
		int a;
};

// main.c
struct Test;

int main(void)
{
		int a = sizeof(struct Test);	// error: invalid application of ‘sizeof’ to incomplete type ‘struct Test’
		return 0;
}
```

### 变量定义和变量声明的区别

#### 变量定义和变量声明的区别

对于如下语句, 哪个是变量定义? 哪个是变量声明?

```c++
int i;			// 变量定义
extern int i;	// 变量声明
```

<u>变量定义</u>: 所谓的定义就是(编译器)创建一个对象, 为这个对象分配一块内存并给它取上一个名字, 这个名字就是我们经常说的变量名或对象名. 但是要注意, 这个名字和内存一旦匹配起来, 就永久绑定(全局变量); 并且这块内存的位置不能发生改变. 一个变量或对象在一定的区域内(比如函数内、全局等)只能被定义一次, 如果定义多次, 编译器会提示用户重复定义了同一个变量或对象.

<u>变量声明</u>: 

- 告诉编译器, 当前的名字已经匹配到一块内存上了, 下面的代码用到变量或对象是在别的地方定义的. 声明是可以出现多次的. 
- 告诉编译器, 当前的名字已经被预定, 别的地方再也不能用它来作为变量名或对象名.

变量定义和声明最重要的区别: 变量定义创建了对象并为这个对象分配了内存, 声明没有分配内存.

### 对象定义和对象声明的区别

#### 对象定义和对象声明不同

对象定义: 

- 申请对象的空间并调用构造函数.

对象声明: 

- 告诉编译器存在这样一个对象.

```c++
Test t;			// 定义对象并调用构造函数

int main()
{
  	// 告诉编译器存在名为 t 的 Test 对象
  	extern Test t;
  	return 0;
}
```



## FAQ





## See Also

https://blog.csdn.net/SlowIsFastLemon/article/details/103701116